import{E as p,F as ee,u as xe,S as ke,v as ve,C as fn,w as hn,e as h,x as ct,y as at,z as We,A as ue,B as ut,G as ft,J as Oe,K as ht,M as D,O as N,d as Ue,b as Re,Q as dn,R as W,V as dt,U as g,W as mn,X as pn,Y as Q,Z as v,_ as gn,$ as yn,a0 as Ve,a1 as z,a2 as xn,a3 as kn,a4 as Sn,a5 as bn,a6 as Cn,a7 as An,a8 as vn,a9 as Mn,aa as Ln,ab as Dn,ac as Bn,r as On,ad as Rn,ae as Tn,af as En,ag as wn,ah as Pn,ai as In,aj as mt,ak as Fn,al as Wn,am as Un,an as Vn,ao as qn,ap as Nn}from"./index-DWhVyDKU.js";import{q as zn,s as Me,x as jn,g as $n,j as Gn,y as E,z as Hn,A as Jn,B as Kn}from"./app-CwvrZGs0.js";const _n=t=>{let{state:e}=t,n=e.doc.lineAt(e.selection.main.from),r=Ne(t.state,n.from);return r.line?Qn(t):r.block?Zn(t):!1};function qe(t,e){return({state:n,dispatch:r})=>{if(n.readOnly)return!1;let o=t(e,n);return o?(r(n.update(o)),!0):!1}}const Qn=qe(tr,0),Yn=qe(pt,0),Zn=qe((t,e)=>pt(t,e,er(e)),0);function Ne(t,e){let n=t.languageDataAt("commentTokens",e);return n.length?n[0]:{}}const _=50;function Xn(t,{open:e,close:n},r,o){let i=t.sliceDoc(r-_,r),s=t.sliceDoc(o,o+_),l=/\s*$/.exec(i)[0].length,c=/^\s*/.exec(s)[0].length,a=i.length-l;if(i.slice(a-e.length,a)==e&&s.slice(c,c+n.length)==n)return{open:{pos:r-l,margin:l&&1},close:{pos:o+c,margin:c&&1}};let u,f;o-r<=2*_?u=f=t.sliceDoc(r,o):(u=t.sliceDoc(r,r+_),f=t.sliceDoc(o-_,o));let m=/^\s*/.exec(u)[0].length,y=/\s*$/.exec(f)[0].length,O=f.length-y-n.length;return u.slice(m,m+e.length)==e&&f.slice(O,O+n.length)==n?{open:{pos:r+m+e.length,margin:/\s/.test(u.charAt(m+e.length))?1:0},close:{pos:o-y-n.length,margin:/\s/.test(f.charAt(O-1))?1:0}}:null}function er(t){let e=[];for(let n of t.selection.ranges){let r=t.doc.lineAt(n.from),o=n.to<=r.to?r:t.doc.lineAt(n.to),i=e.length-1;i>=0&&e[i].to>r.from?e[i].to=o.to:e.push({from:r.from+/^\s*/.exec(r.text)[0].length,to:o.to})}return e}function pt(t,e,n=e.selection.ranges){let r=n.map(i=>Ne(e,i.from).block);if(!r.every(i=>i))return null;let o=n.map((i,s)=>Xn(e,r[s],i.from,i.to));if(t!=2&&!o.every(i=>i))return{changes:e.changes(n.map((i,s)=>o[s]?[]:[{from:i.from,insert:r[s].open+" "},{from:i.to,insert:" "+r[s].close}]))};if(t!=1&&o.some(i=>i)){let i=[];for(let s=0,l;s<o.length;s++)if(l=o[s]){let c=r[s],{open:a,close:u}=l;i.push({from:a.pos-c.open.length,to:a.pos+a.margin},{from:u.pos-u.margin,to:u.pos+c.close.length})}return{changes:i}}return null}function tr(t,e,n=e.selection.ranges){let r=[],o=-1;for(let{from:i,to:s}of n){let l=r.length,c=1e9,a=Ne(e,i).line;if(a){for(let u=i;u<=s;){let f=e.doc.lineAt(u);if(f.from>o&&(i==s||s>f.from)){o=f.from;let m=/^\s*/.exec(f.text)[0].length,y=m==f.length,O=f.text.slice(m,m+a.length)==a?m:-1;m<f.text.length&&m<c&&(c=m),r.push({line:f,comment:O,token:a,indent:m,empty:y,single:!1})}u=f.to+1}if(c<1e9)for(let u=l;u<r.length;u++)r[u].indent<r[u].line.text.length&&(r[u].indent=c);r.length==l+1&&(r[l].single=!0)}}if(t!=2&&r.some(i=>i.comment<0&&(!i.empty||i.single))){let i=[];for(let{line:l,token:c,indent:a,empty:u,single:f}of r)(f||!u)&&i.push({from:l.from+a,insert:c+" "});let s=e.changes(i);return{changes:s,selection:e.selection.map(s,1)}}else if(t!=1&&r.some(i=>i.comment>=0)){let i=[];for(let{line:s,comment:l,token:c}of r)if(l>=0){let a=s.from+l,u=a+c.length;s.text[u-s.from]==" "&&u++,i.push({from:a,to:u})}return{changes:i}}return null}const Te=ht.define(),nr=ht.define(),rr=ee.define(),gt=ee.define({combine(t){return xe(t,{minDepth:100,newGroupDelay:500,joinToEvent:(e,n)=>n},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,n)=>(r,o)=>e(r,o)||n(r,o)})}}),yt=ke.define({create(){return R.empty},update(t,e){let n=e.state.facet(gt),r=e.annotation(Te);if(r){let c=S.fromTransaction(e,r.selection),a=r.side,u=a==0?t.undone:t.done;return c?u=fe(u,u.length,n.minDepth,c):u=St(u,e.startState.selection),new R(a==0?r.rest:u,a==0?u:r.rest)}let o=e.annotation(nr);if((o=="full"||o=="before")&&(t=t.isolate()),e.annotation(ve.addToHistory)===!1)return e.changes.empty?t:t.addMapping(e.changes.desc);let i=S.fromTransaction(e),s=e.annotation(ve.time),l=e.annotation(ve.userEvent);return i?t=t.addChanges(i,s,l,n,e):e.selection&&(t=t.addSelection(e.startState.selection,s,l,n.newGroupDelay)),(o=="full"||o=="after")&&(t=t.isolate()),t},toJSON(t){return{done:t.done.map(e=>e.toJSON()),undone:t.undone.map(e=>e.toJSON())}},fromJSON(t){return new R(t.done.map(S.fromJSON),t.undone.map(S.fromJSON))}});function or(t={}){return[yt,gt.of(t),p.domEventHandlers({beforeinput(e,n){let r=e.inputType=="historyUndo"?xt:e.inputType=="historyRedo"?Ee:null;return r?(e.preventDefault(),r(n)):!1}})]}function Se(t,e){return function({state:n,dispatch:r}){if(!e&&n.readOnly)return!1;let o=n.field(yt,!1);if(!o)return!1;let i=o.pop(t,n,e);return i?(r(i),!0):!1}}const xt=Se(0,!1),Ee=Se(1,!1),ir=Se(0,!0),sr=Se(1,!0);class S{constructor(e,n,r,o,i){this.changes=e,this.effects=n,this.mapped=r,this.startSelection=o,this.selectionsAfter=i}setSelAfter(e){return new S(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,n,r;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(n=this.mapped)===null||n===void 0?void 0:n.toJSON(),startSelection:(r=this.startSelection)===null||r===void 0?void 0:r.toJSON(),selectionsAfter:this.selectionsAfter.map(o=>o.toJSON())}}static fromJSON(e){return new S(e.changes&&fn.fromJSON(e.changes),[],e.mapped&&hn.fromJSON(e.mapped),e.startSelection&&h.fromJSON(e.startSelection),e.selectionsAfter.map(h.fromJSON))}static fromTransaction(e,n){let r=M;for(let o of e.startState.facet(rr)){let i=o(e);i.length&&(r=r.concat(i))}return!r.length&&e.changes.empty?null:new S(e.changes.invert(e.startState.doc),r,void 0,n||e.startState.selection,M)}static selection(e){return new S(void 0,M,void 0,void 0,e)}}function fe(t,e,n,r){let o=e+1>n+20?e-n-1:0,i=t.slice(o,e);return i.push(r),i}function lr(t,e){let n=[],r=!1;return t.iterChangedRanges((o,i)=>n.push(o,i)),e.iterChangedRanges((o,i,s,l)=>{for(let c=0;c<n.length;){let a=n[c++],u=n[c++];l>=a&&s<=u&&(r=!0)}}),r}function cr(t,e){return t.ranges.length==e.ranges.length&&t.ranges.filter((n,r)=>n.empty!=e.ranges[r].empty).length===0}function kt(t,e){return t.length?e.length?t.concat(e):t:e}const M=[],ar=200;function St(t,e){if(t.length){let n=t[t.length-1],r=n.selectionsAfter.slice(Math.max(0,n.selectionsAfter.length-ar));return r.length&&r[r.length-1].eq(e)?t:(r.push(e),fe(t,t.length-1,1e9,n.setSelAfter(r)))}else return[S.selection([e])]}function ur(t){let e=t[t.length-1],n=t.slice();return n[t.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),n}function Le(t,e){if(!t.length)return t;let n=t.length,r=M;for(;n;){let o=fr(t[n-1],e,r);if(o.changes&&!o.changes.empty||o.effects.length){let i=t.slice(0,n);return i[n-1]=o,i}else e=o.mapped,n--,r=o.selectionsAfter}return r.length?[S.selection(r)]:M}function fr(t,e,n){let r=kt(t.selectionsAfter.length?t.selectionsAfter.map(l=>l.map(e)):M,n);if(!t.changes)return S.selection(r);let o=t.changes.map(e),i=e.mapDesc(t.changes,!0),s=t.mapped?t.mapped.composeDesc(i):i;return new S(o,D.mapEffects(t.effects,e),s,t.startSelection.map(i),r)}const hr=/^(input\.type|delete)($|\.)/;class R{constructor(e,n,r=0,o=void 0){this.done=e,this.undone=n,this.prevTime=r,this.prevUserEvent=o}isolate(){return this.prevTime?new R(this.done,this.undone):this}addChanges(e,n,r,o,i){let s=this.done,l=s[s.length-1];return l&&l.changes&&!l.changes.empty&&e.changes&&(!r||hr.test(r))&&(!l.selectionsAfter.length&&n-this.prevTime<o.newGroupDelay&&o.joinToEvent(i,lr(l.changes,e.changes))||r=="input.type.compose")?s=fe(s,s.length-1,o.minDepth,new S(e.changes.compose(l.changes),kt(e.effects,l.effects),l.mapped,l.startSelection,M)):s=fe(s,s.length,o.minDepth,e),new R(s,M,n,r)}addSelection(e,n,r,o){let i=this.done.length?this.done[this.done.length-1].selectionsAfter:M;return i.length>0&&n-this.prevTime<o&&r==this.prevUserEvent&&r&&/^select($|\.)/.test(r)&&cr(i[i.length-1],e)?this:new R(St(this.done,e),this.undone,n,r)}addMapping(e){return new R(Le(this.done,e),Le(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,n,r){let o=e==0?this.done:this.undone;if(o.length==0)return null;let i=o[o.length-1],s=i.selectionsAfter[0]||n.selection;if(r&&i.selectionsAfter.length)return n.update({selection:i.selectionsAfter[i.selectionsAfter.length-1],annotations:Te.of({side:e,rest:ur(o),selection:s}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(i.changes){let l=o.length==1?M:o.slice(0,o.length-1);return i.mapped&&(l=Le(l,i.mapped)),n.update({changes:i.changes,selection:i.startSelection,effects:i.effects,annotations:Te.of({side:e,rest:l,selection:s}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}}R.empty=new R(M,M);const dr=[{key:"Mod-z",run:xt,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:Ee,preventDefault:!0},{linux:"Ctrl-Shift-z",run:Ee,preventDefault:!0},{key:"Mod-u",run:ir,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:sr,preventDefault:!0}];function H(t,e){return h.create(t.ranges.map(e),t.mainIndex)}function T(t,e){return t.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function B({state:t,dispatch:e},n){let r=H(t.selection,n);return r.eq(t.selection,!0)?!1:(e(T(t,r)),!0)}function be(t,e){return h.cursor(e?t.to:t.from)}function bt(t,e){return B(t,n=>n.empty?t.moveByChar(n,e):be(n,e))}function x(t){return t.textDirectionAt(t.state.selection.main.head)==dn.LTR}const Ct=t=>bt(t,!x(t)),At=t=>bt(t,x(t));function vt(t,e){return B(t,n=>n.empty?t.moveByGroup(n,e):be(n,e))}const mr=t=>vt(t,!x(t)),pr=t=>vt(t,x(t));function gr(t,e,n){if(e.type.prop(n))return!0;let r=e.to-e.from;return r&&(r>2||/[^\s,.;:]/.test(t.sliceDoc(e.from,e.to)))||e.firstChild}function Ce(t,e,n){let r=Ue(t).resolveInner(e.head),o=n?Re.closedBy:Re.openedBy;for(let c=e.head;;){let a=n?r.childAfter(c):r.childBefore(c);if(!a)break;gr(t,a,o)?r=a:c=n?a.to:a.from}let i=r.type.prop(o),s,l;return i&&(s=n?N(t,r.from,1):N(t,r.to,-1))&&s.matched?l=n?s.end.to:s.end.from:l=n?r.to:r.from,h.cursor(l,n?-1:1)}const yr=t=>B(t,e=>Ce(t.state,e,!x(t))),xr=t=>B(t,e=>Ce(t.state,e,x(t)));function Mt(t,e){return B(t,n=>{if(!n.empty)return be(n,e);let r=t.moveVertically(n,e);return r.head!=n.head?r:t.moveToLineBoundary(n,e)})}const Lt=t=>Mt(t,!1),Dt=t=>Mt(t,!0);function Bt(t){let e=t.scrollDOM.clientHeight<t.scrollDOM.scrollHeight-2,n=0,r=0,o;if(e){for(let i of t.state.facet(p.scrollMargins)){let s=i(t);s!=null&&s.top&&(n=Math.max(s==null?void 0:s.top,n)),s!=null&&s.bottom&&(r=Math.max(s==null?void 0:s.bottom,r))}o=t.scrollDOM.clientHeight-n-r}else o=(t.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:n,marginBottom:r,selfScroll:e,height:Math.max(t.defaultLineHeight,o-5)}}function Ot(t,e){let n=Bt(t),{state:r}=t,o=H(r.selection,s=>s.empty?t.moveVertically(s,e,n.height):be(s,e));if(o.eq(r.selection))return!1;let i;if(n.selfScroll){let s=t.coordsAtPos(r.selection.main.head),l=t.scrollDOM.getBoundingClientRect(),c=l.top+n.marginTop,a=l.bottom-n.marginBottom;s&&s.top>c&&s.bottom<a&&(i=p.scrollIntoView(o.main.head,{y:"start",yMargin:s.top-c}))}return t.dispatch(T(r,o),{effects:i}),!0}const Ke=t=>Ot(t,!1),we=t=>Ot(t,!0);function P(t,e,n){let r=t.lineBlockAt(e.head),o=t.moveToLineBoundary(e,n);if(o.head==e.head&&o.head!=(n?r.to:r.from)&&(o=t.moveToLineBoundary(e,n,!1)),!n&&o.head==r.from&&r.length){let i=/^\s*/.exec(t.state.sliceDoc(r.from,Math.min(r.from+100,r.to)))[0].length;i&&e.head!=r.from+i&&(o=h.cursor(r.from+i))}return o}const kr=t=>B(t,e=>P(t,e,!0)),Sr=t=>B(t,e=>P(t,e,!1)),br=t=>B(t,e=>P(t,e,!x(t))),Cr=t=>B(t,e=>P(t,e,x(t))),Ar=t=>B(t,e=>h.cursor(t.lineBlockAt(e.head).from,1)),vr=t=>B(t,e=>h.cursor(t.lineBlockAt(e.head).to,-1));function Mr(t,e,n){let r=!1,o=H(t.selection,i=>{let s=N(t,i.head,-1)||N(t,i.head,1)||i.head>0&&N(t,i.head-1,1)||i.head<t.doc.length&&N(t,i.head+1,-1);if(!s||!s.end)return i;r=!0;let l=s.start.from==i.head?s.end.to:s.end.from;return h.cursor(l)});return r?(e(T(t,o)),!0):!1}const Lr=({state:t,dispatch:e})=>Mr(t,e);function L(t,e){let n=H(t.state.selection,r=>{let o=e(r);return h.range(r.anchor,o.head,o.goalColumn,o.bidiLevel||void 0)});return n.eq(t.state.selection)?!1:(t.dispatch(T(t.state,n)),!0)}function Rt(t,e){return L(t,n=>t.moveByChar(n,e))}const Tt=t=>Rt(t,!x(t)),Et=t=>Rt(t,x(t));function wt(t,e){return L(t,n=>t.moveByGroup(n,e))}const Dr=t=>wt(t,!x(t)),Br=t=>wt(t,x(t)),Or=t=>L(t,e=>Ce(t.state,e,!x(t))),Rr=t=>L(t,e=>Ce(t.state,e,x(t)));function Pt(t,e){return L(t,n=>t.moveVertically(n,e))}const It=t=>Pt(t,!1),Ft=t=>Pt(t,!0);function Wt(t,e){return L(t,n=>t.moveVertically(n,e,Bt(t).height))}const _e=t=>Wt(t,!1),Qe=t=>Wt(t,!0),Tr=t=>L(t,e=>P(t,e,!0)),Er=t=>L(t,e=>P(t,e,!1)),wr=t=>L(t,e=>P(t,e,!x(t))),Pr=t=>L(t,e=>P(t,e,x(t))),Ir=t=>L(t,e=>h.cursor(t.lineBlockAt(e.head).from)),Fr=t=>L(t,e=>h.cursor(t.lineBlockAt(e.head).to)),Ye=({state:t,dispatch:e})=>(e(T(t,{anchor:0})),!0),Ze=({state:t,dispatch:e})=>(e(T(t,{anchor:t.doc.length})),!0),Xe=({state:t,dispatch:e})=>(e(T(t,{anchor:t.selection.main.anchor,head:0})),!0),et=({state:t,dispatch:e})=>(e(T(t,{anchor:t.selection.main.anchor,head:t.doc.length})),!0),Wr=({state:t,dispatch:e})=>(e(t.update({selection:{anchor:0,head:t.doc.length},userEvent:"select"})),!0),Ur=({state:t,dispatch:e})=>{let n=Ae(t).map(({from:r,to:o})=>h.range(r,Math.min(o+1,t.doc.length)));return e(t.update({selection:h.create(n),userEvent:"select"})),!0},Vr=({state:t,dispatch:e})=>{let n=H(t.selection,r=>{var o;let i=Ue(t).resolveStack(r.from,1);for(let s=i;s;s=s.next){let{node:l}=s;if((l.from<r.from&&l.to>=r.to||l.to>r.to&&l.from<=r.from)&&(!((o=l.parent)===null||o===void 0)&&o.parent))return h.range(l.to,l.from)}return r});return e(T(t,n)),!0},qr=({state:t,dispatch:e})=>{let n=t.selection,r=null;return n.ranges.length>1?r=h.create([n.main]):n.main.empty||(r=h.create([h.cursor(n.main.head)])),r?(e(T(t,r)),!0):!1};function te(t,e){if(t.state.readOnly)return!1;let n="delete.selection",{state:r}=t,o=r.changeByRange(i=>{let{from:s,to:l}=i;if(s==l){let c=e(i);c<s?(n="delete.backward",c=oe(t,c,!1)):c>s&&(n="delete.forward",c=oe(t,c,!0)),s=Math.min(s,c),l=Math.max(l,c)}else s=oe(t,s,!1),l=oe(t,l,!0);return s==l?{range:i}:{changes:{from:s,to:l},range:h.cursor(s,s<i.head?-1:1)}});return o.changes.empty?!1:(t.dispatch(r.update(o,{scrollIntoView:!0,userEvent:n,effects:n=="delete.selection"?p.announce.of(r.phrase("Selection deleted")):void 0})),!0)}function oe(t,e,n){if(t instanceof p)for(let r of t.state.facet(p.atomicRanges).map(o=>o(t)))r.between(e,e,(o,i)=>{o<e&&i>e&&(e=n?i:o)});return e}const Ut=(t,e,n)=>te(t,r=>{let o=r.from,{state:i}=t,s=i.doc.lineAt(o),l,c;if(n&&!e&&o>s.from&&o<s.from+200&&!/[^ \t]/.test(l=s.text.slice(0,o-s.from))){if(l[l.length-1]=="	")return o-1;let a=We(l,i.tabSize),u=a%Oe(i)||Oe(i);for(let f=0;f<u&&l[l.length-1-f]==" ";f++)o--;c=o}else c=W(s.text,o-s.from,e,e)+s.from,c==o&&s.number!=(e?i.doc.lines:1)?c+=e?1:-1:!e&&/[\ufe00-\ufe0f]/.test(s.text.slice(c-s.from,o-s.from))&&(c=W(s.text,c-s.from,!1,!1)+s.from);return c}),Pe=t=>Ut(t,!1,!0),Vt=t=>Ut(t,!0,!1),qt=(t,e)=>te(t,n=>{let r=n.head,{state:o}=t,i=o.doc.lineAt(r),s=o.charCategorizer(r);for(let l=null;;){if(r==(e?i.to:i.from)){r==n.head&&i.number!=(e?o.doc.lines:1)&&(r+=e?1:-1);break}let c=W(i.text,r-i.from,e)+i.from,a=i.text.slice(Math.min(r,c)-i.from,Math.max(r,c)-i.from),u=s(a);if(l!=null&&u!=l)break;(a!=" "||r!=n.head)&&(l=u),r=c}return r}),Nt=t=>qt(t,!1),Nr=t=>qt(t,!0),zr=t=>te(t,e=>{let n=t.lineBlockAt(e.head).to;return e.head<n?n:Math.min(t.state.doc.length,e.head+1)}),jr=t=>te(t,e=>{let n=t.moveToLineBoundary(e,!1).head;return e.head>n?n:Math.max(0,e.head-1)}),$r=t=>te(t,e=>{let n=t.moveToLineBoundary(e,!0).head;return e.head<n?n:Math.min(t.state.doc.length,e.head+1)}),Gr=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let n=t.changeByRange(r=>({changes:{from:r.from,to:r.to,insert:ut.of(["",""])},range:h.cursor(r.from)}));return e(t.update(n,{scrollIntoView:!0,userEvent:"input"})),!0},Hr=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let n=t.changeByRange(r=>{if(!r.empty||r.from==0||r.from==t.doc.length)return{range:r};let o=r.from,i=t.doc.lineAt(o),s=o==i.from?o-1:W(i.text,o-i.from,!1)+i.from,l=o==i.to?o+1:W(i.text,o-i.from,!0)+i.from;return{changes:{from:s,to:l,insert:t.doc.slice(o,l).append(t.doc.slice(s,o))},range:h.cursor(l)}});return n.changes.empty?!1:(e(t.update(n,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function Ae(t){let e=[],n=-1;for(let r of t.selection.ranges){let o=t.doc.lineAt(r.from),i=t.doc.lineAt(r.to);if(!r.empty&&r.to==i.from&&(i=t.doc.lineAt(r.to-1)),n>=o.number){let s=e[e.length-1];s.to=i.to,s.ranges.push(r)}else e.push({from:o.from,to:i.to,ranges:[r]});n=i.number+1}return e}function zt(t,e,n){if(t.readOnly)return!1;let r=[],o=[];for(let i of Ae(t)){if(n?i.to==t.doc.length:i.from==0)continue;let s=t.doc.lineAt(n?i.to+1:i.from-1),l=s.length+1;if(n){r.push({from:i.to,to:s.to},{from:i.from,insert:s.text+t.lineBreak});for(let c of i.ranges)o.push(h.range(Math.min(t.doc.length,c.anchor+l),Math.min(t.doc.length,c.head+l)))}else{r.push({from:s.from,to:i.from},{from:i.to,insert:t.lineBreak+s.text});for(let c of i.ranges)o.push(h.range(c.anchor-l,c.head-l))}}return r.length?(e(t.update({changes:r,scrollIntoView:!0,selection:h.create(o,t.selection.mainIndex),userEvent:"move.line"})),!0):!1}const Jr=({state:t,dispatch:e})=>zt(t,e,!1),Kr=({state:t,dispatch:e})=>zt(t,e,!0);function jt(t,e,n){if(t.readOnly)return!1;let r=[];for(let o of Ae(t))n?r.push({from:o.from,insert:t.doc.slice(o.from,o.to)+t.lineBreak}):r.push({from:o.to,insert:t.lineBreak+t.doc.slice(o.from,o.to)});return e(t.update({changes:r,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const _r=({state:t,dispatch:e})=>jt(t,e,!1),Qr=({state:t,dispatch:e})=>jt(t,e,!0),Yr=t=>{if(t.state.readOnly)return!1;let{state:e}=t,n=e.changes(Ae(e).map(({from:o,to:i})=>(o>0?o--:i<e.doc.length&&i++,{from:o,to:i}))),r=H(e.selection,o=>{let i;if(t.lineWrapping){let s=t.lineBlockAt(o.head),l=t.coordsAtPos(o.head,o.assoc||1);l&&(i=s.bottom+t.documentTop-l.bottom+t.defaultLineHeight/2)}return t.moveVertically(o,!0,i)}).map(n);return t.dispatch({changes:n,selection:r,scrollIntoView:!0,userEvent:"delete.line"}),!0};function Zr(t,e){if(/\(\)|\[\]|\{\}/.test(t.sliceDoc(e-1,e+1)))return{from:e,to:e};let n=Ue(t).resolveInner(e),r=n.childBefore(e),o=n.childAfter(e),i;return r&&o&&r.to<=e&&o.from>=e&&(i=r.type.prop(Re.closedBy))&&i.indexOf(o.name)>-1&&t.doc.lineAt(r.to).from==t.doc.lineAt(o.from).from&&!/\S/.test(t.sliceDoc(r.to,o.from))?{from:r.to,to:o.from}:null}const Xr=$t(!1),eo=$t(!0);function $t(t){return({state:e,dispatch:n})=>{if(e.readOnly)return!1;let r=e.changeByRange(o=>{let{from:i,to:s}=o,l=e.doc.lineAt(i),c=!t&&i==s&&Zr(e,i);t&&(i=s=(s<=l.to?l:e.doc.lineAt(s)).to);let a=new ct(e,{simulateBreak:i,simulateDoubleBreak:!!c}),u=at(a,i);for(u==null&&(u=We(/^\s*/.exec(e.doc.lineAt(i).text)[0],e.tabSize));s<l.to&&/\s/.test(l.text[s-l.from]);)s++;c?{from:i,to:s}=c:i>l.from&&i<l.from+100&&!/\S/.test(l.text.slice(0,i))&&(i=l.from);let f=["",ue(e,u)];return c&&f.push(ue(e,a.lineIndent(l.from,-1))),{changes:{from:i,to:s,insert:ut.of(f)},range:h.cursor(i+1+f[1].length)}});return n(e.update(r,{scrollIntoView:!0,userEvent:"input"})),!0}}function ze(t,e){let n=-1;return t.changeByRange(r=>{let o=[];for(let s=r.from;s<=r.to;){let l=t.doc.lineAt(s);l.number>n&&(r.empty||r.to>l.from)&&(e(l,o,r),n=l.number),s=l.to+1}let i=t.changes(o);return{changes:o,range:h.range(i.mapPos(r.anchor,1),i.mapPos(r.head,1))}})}const to=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let n=Object.create(null),r=new ct(t,{overrideIndentation:i=>{let s=n[i];return s??-1}}),o=ze(t,(i,s,l)=>{let c=at(r,i.from);if(c==null)return;/\S/.test(i.text)||(c=0);let a=/^\s*/.exec(i.text)[0],u=ue(t,c);(a!=u||l.from<i.from+a.length)&&(n[i.from]=c,s.push({from:i.from,to:i.from+a.length,insert:u}))});return o.changes.empty||e(t.update(o,{userEvent:"indent"})),!0},Gt=({state:t,dispatch:e})=>t.readOnly?!1:(e(t.update(ze(t,(n,r)=>{r.push({from:n.from,insert:t.facet(ft)})}),{userEvent:"input.indent"})),!0),Ht=({state:t,dispatch:e})=>t.readOnly?!1:(e(t.update(ze(t,(n,r)=>{let o=/^\s*/.exec(n.text)[0];if(!o)return;let i=We(o,t.tabSize),s=0,l=ue(t,Math.max(0,i-Oe(t)));for(;s<o.length&&s<l.length&&o.charCodeAt(s)==l.charCodeAt(s);)s++;r.push({from:n.from+s,to:n.from+o.length,insert:l.slice(s)})}),{userEvent:"delete.dedent"})),!0),no=t=>(t.setTabFocusMode(),!0),ro=[{key:"Ctrl-b",run:Ct,shift:Tt,preventDefault:!0},{key:"Ctrl-f",run:At,shift:Et},{key:"Ctrl-p",run:Lt,shift:It},{key:"Ctrl-n",run:Dt,shift:Ft},{key:"Ctrl-a",run:Ar,shift:Ir},{key:"Ctrl-e",run:vr,shift:Fr},{key:"Ctrl-d",run:Vt},{key:"Ctrl-h",run:Pe},{key:"Ctrl-k",run:zr},{key:"Ctrl-Alt-h",run:Nt},{key:"Ctrl-o",run:Gr},{key:"Ctrl-t",run:Hr},{key:"Ctrl-v",run:we}],oo=[{key:"ArrowLeft",run:Ct,shift:Tt,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:mr,shift:Dr,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:br,shift:wr,preventDefault:!0},{key:"ArrowRight",run:At,shift:Et,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:pr,shift:Br,preventDefault:!0},{mac:"Cmd-ArrowRight",run:Cr,shift:Pr,preventDefault:!0},{key:"ArrowUp",run:Lt,shift:It,preventDefault:!0},{mac:"Cmd-ArrowUp",run:Ye,shift:Xe},{mac:"Ctrl-ArrowUp",run:Ke,shift:_e},{key:"ArrowDown",run:Dt,shift:Ft,preventDefault:!0},{mac:"Cmd-ArrowDown",run:Ze,shift:et},{mac:"Ctrl-ArrowDown",run:we,shift:Qe},{key:"PageUp",run:Ke,shift:_e},{key:"PageDown",run:we,shift:Qe},{key:"Home",run:Sr,shift:Er,preventDefault:!0},{key:"Mod-Home",run:Ye,shift:Xe},{key:"End",run:kr,shift:Tr,preventDefault:!0},{key:"Mod-End",run:Ze,shift:et},{key:"Enter",run:Xr},{key:"Mod-a",run:Wr},{key:"Backspace",run:Pe,shift:Pe},{key:"Delete",run:Vt},{key:"Mod-Backspace",mac:"Alt-Backspace",run:Nt},{key:"Mod-Delete",mac:"Alt-Delete",run:Nr},{mac:"Mod-Backspace",run:jr},{mac:"Mod-Delete",run:$r}].concat(ro.map(t=>({mac:t.key,run:t.run,shift:t.shift}))),io=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:yr,shift:Or},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:xr,shift:Rr},{key:"Alt-ArrowUp",run:Jr},{key:"Shift-Alt-ArrowUp",run:_r},{key:"Alt-ArrowDown",run:Kr},{key:"Shift-Alt-ArrowDown",run:Qr},{key:"Escape",run:qr},{key:"Mod-Enter",run:eo},{key:"Alt-l",mac:"Ctrl-l",run:Ur},{key:"Mod-i",run:Vr,preventDefault:!0},{key:"Mod-[",run:Ht},{key:"Mod-]",run:Gt},{key:"Mod-Alt-\\",run:to},{key:"Shift-Mod-k",run:Yr},{key:"Shift-Mod-\\",run:Lr},{key:"Mod-/",run:_n},{key:"Alt-A",run:Yn},{key:"Ctrl-m",mac:"Shift-Alt-m",run:no}].concat(oo),so={key:"Tab",run:Gt,shift:Ht};function d(){var t=arguments[0];typeof t=="string"&&(t=document.createElement(t));var e=1,n=arguments[1];if(n&&typeof n=="object"&&n.nodeType==null&&!Array.isArray(n)){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var o=n[r];typeof o=="string"?t.setAttribute(r,o):o!=null&&(t[r]=o)}e++}for(;e<arguments.length;e++)Jt(t,arguments[e]);return t}function Jt(t,e){if(typeof e=="string")t.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)t.appendChild(e);else if(Array.isArray(e))for(var n=0;n<e.length;n++)Jt(t,e[n]);else throw new RangeError("Unsupported child node: "+e)}const tt=typeof String.prototype.normalize=="function"?t=>t.normalize("NFKD"):t=>t;class ${constructor(e,n,r=0,o=e.length,i,s){this.test=s,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(r,o),this.bufferStart=r,this.normalize=i?l=>i(tt(l)):tt,this.query=this.normalize(n)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return mn(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let n=yn(e),r=this.bufferStart+this.bufferPos;this.bufferPos+=pn(e);let o=this.normalize(n);for(let i=0,s=r;;i++){let l=o.charCodeAt(i),c=this.match(l,s,this.bufferPos+this.bufferStart);if(i==o.length-1){if(c)return this.value=c,this;break}s==r&&i<n.length&&n.charCodeAt(i)==l&&s++}}}match(e,n,r){let o=null;for(let i=0;i<this.matches.length;i+=2){let s=this.matches[i],l=!1;this.query.charCodeAt(s)==e&&(s==this.query.length-1?o={from:this.matches[i+1],to:r}:(this.matches[i]++,l=!0)),l||(this.matches.splice(i,2),i-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?o={from:n,to:r}:this.matches.push(1,n)),o&&this.test&&!this.test(o.from,o.to,this.buffer,this.bufferStart)&&(o=null),o}}typeof Symbol<"u"&&($.prototype[Symbol.iterator]=function(){return this});const Kt={from:-1,to:-1,match:/.*/.exec("")},je="gm"+(/x/.unicode==null?"":"u");class _t{constructor(e,n,r,o=0,i=e.length){if(this.text=e,this.to=i,this.curLine="",this.done=!1,this.value=Kt,/\\[sWDnr]|\n|\r|\[\^/.test(n))return new Qt(e,n,r,o,i);this.re=new RegExp(n,je+(r!=null&&r.ignoreCase?"i":"")),this.test=r==null?void 0:r.test,this.iter=e.iter();let s=e.lineAt(o);this.curLineStart=s.from,this.matchPos=he(e,o),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let n=this.matchPos<=this.to&&this.re.exec(this.curLine);if(n){let r=this.curLineStart+n.index,o=r+n[0].length;if(this.matchPos=he(this.text,o+(r==o?1:0)),r==this.curLineStart+this.curLine.length&&this.nextLine(),(r<o||r>this.value.to)&&(!this.test||this.test(r,o,n)))return this.value={from:r,to:o,match:n},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}}const De=new WeakMap;class j{constructor(e,n){this.from=e,this.text=n}get to(){return this.from+this.text.length}static get(e,n,r){let o=De.get(e);if(!o||o.from>=r||o.to<=n){let l=new j(n,e.sliceString(n,r));return De.set(e,l),l}if(o.from==n&&o.to==r)return o;let{text:i,from:s}=o;return s>n&&(i=e.sliceString(n,s)+i,s=n),o.to<r&&(i+=e.sliceString(o.to,r)),De.set(e,new j(s,i)),new j(n,i.slice(n-s,r-s))}}class Qt{constructor(e,n,r,o,i){this.text=e,this.to=i,this.done=!1,this.value=Kt,this.matchPos=he(e,o),this.re=new RegExp(n,je+(r!=null&&r.ignoreCase?"i":"")),this.test=r==null?void 0:r.test,this.flat=j.get(e,o,this.chunkEnd(o+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,n=this.re.exec(this.flat.text);if(n&&!n[0]&&n.index==e&&(this.re.lastIndex=e+1,n=this.re.exec(this.flat.text)),n){let r=this.flat.from+n.index,o=r+n[0].length;if((this.flat.to>=this.to||n.index+n[0].length<=this.flat.text.length-10)&&(!this.test||this.test(r,o,n)))return this.value={from:r,to:o,match:n},this.matchPos=he(this.text,o+(r==o?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=j.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(_t.prototype[Symbol.iterator]=Qt.prototype[Symbol.iterator]=function(){return this});function lo(t){try{return new RegExp(t,je),!0}catch{return!1}}function he(t,e){if(e>=t.length)return e;let n=t.lineAt(e),r;for(;e<n.to&&(r=n.text.charCodeAt(e-n.from))>=56320&&r<57344;)e++;return e}function Ie(t){let e=String(t.state.doc.lineAt(t.state.selection.main.head).number),n=d("input",{class:"cm-textfield",name:"line",value:e}),r=d("form",{class:"cm-gotoLine",onkeydown:i=>{i.keyCode==27?(i.preventDefault(),t.dispatch({effects:de.of(!1)}),t.focus()):i.keyCode==13&&(i.preventDefault(),o())},onsubmit:i=>{i.preventDefault(),o()}},d("label",t.state.phrase("Go to line"),": ",n)," ",d("button",{class:"cm-button",type:"submit"},t.state.phrase("go")));function o(){let i=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(n.value);if(!i)return;let{state:s}=t,l=s.doc.lineAt(s.selection.main.head),[,c,a,u,f]=i,m=u?+u.slice(1):0,y=a?+a:l.number;if(a&&f){let K=y/100;c&&(K=K*(c=="-"?-1:1)+l.number/s.doc.lines),y=Math.round(s.doc.lines*K)}else a&&c&&(y=y*(c=="-"?-1:1)+l.number);let O=s.doc.line(Math.max(1,Math.min(s.doc.lines,y))),re=h.cursor(O.from+Math.max(0,Math.min(m,O.length)));t.dispatch({effects:[de.of(!1),p.scrollIntoView(re.from,{y:"center"})],selection:re}),t.focus()}return{dom:r}}const de=D.define(),nt=ke.define({create(){return!0},update(t,e){for(let n of e.effects)n.is(de)&&(t=n.value);return t},provide:t=>Ve.from(t,e=>e?Ie:null)}),co=t=>{let e=Q(t,Ie);if(!e){let n=[de.of(!0)];t.state.field(nt,!1)==null&&n.push(D.appendConfig.of([nt,ao])),t.dispatch({effects:n}),e=Q(t,Ie)}return e&&e.dom.querySelector("input").select(),!0},ao=p.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),uo={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},fo=ee.define({combine(t){return xe(t,uo,{highlightWordAroundCursor:(e,n)=>e||n,minSelectionLength:Math.min,maxMatches:Math.min})}});function ho(t){return[xo,yo]}const mo=g.mark({class:"cm-selectionMatch"}),po=g.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function rt(t,e,n,r){return(n==0||t(e.sliceDoc(n-1,n))!=v.Word)&&(r==e.doc.length||t(e.sliceDoc(r,r+1))!=v.Word)}function go(t,e,n,r){return t(e.sliceDoc(n,n+1))==v.Word&&t(e.sliceDoc(r-1,r))==v.Word}const yo=dt.fromClass(class{constructor(t){this.decorations=this.getDeco(t)}update(t){(t.selectionSet||t.docChanged||t.viewportChanged)&&(this.decorations=this.getDeco(t.view))}getDeco(t){let e=t.state.facet(fo),{state:n}=t,r=n.selection;if(r.ranges.length>1)return g.none;let o=r.main,i,s=null;if(o.empty){if(!e.highlightWordAroundCursor)return g.none;let c=n.wordAt(o.head);if(!c)return g.none;s=n.charCategorizer(o.head),i=n.sliceDoc(c.from,c.to)}else{let c=o.to-o.from;if(c<e.minSelectionLength||c>200)return g.none;if(e.wholeWords){if(i=n.sliceDoc(o.from,o.to),s=n.charCategorizer(o.head),!(rt(s,n,o.from,o.to)&&go(s,n,o.from,o.to)))return g.none}else if(i=n.sliceDoc(o.from,o.to),!i)return g.none}let l=[];for(let c of t.visibleRanges){let a=new $(n.doc,i,c.from,c.to);for(;!a.next().done;){let{from:u,to:f}=a.value;if((!s||rt(s,n,u,f))&&(o.empty&&u<=o.from&&f>=o.to?l.push(po.range(u,f)):(u>=o.to||f<=o.from)&&l.push(mo.range(u,f)),l.length>e.maxMatches))return g.none}}return g.set(l)}},{decorations:t=>t.decorations}),xo=p.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),ko=({state:t,dispatch:e})=>{let{selection:n}=t,r=h.create(n.ranges.map(o=>t.wordAt(o.head)||h.cursor(o.head)),n.mainIndex);return r.eq(n)?!1:(e(t.update({selection:r})),!0)};function So(t,e){let{main:n,ranges:r}=t.selection,o=t.wordAt(n.head),i=o&&o.from==n.from&&o.to==n.to;for(let s=!1,l=new $(t.doc,e,r[r.length-1].to);;)if(l.next(),l.done){if(s)return null;l=new $(t.doc,e,0,Math.max(0,r[r.length-1].from-1)),s=!0}else{if(s&&r.some(c=>c.from==l.value.from))continue;if(i){let c=t.wordAt(l.value.from);if(!c||c.from!=l.value.from||c.to!=l.value.to)continue}return l.value}}const bo=({state:t,dispatch:e})=>{let{ranges:n}=t.selection;if(n.some(i=>i.from===i.to))return ko({state:t,dispatch:e});let r=t.sliceDoc(n[0].from,n[0].to);if(t.selection.ranges.some(i=>t.sliceDoc(i.from,i.to)!=r))return!1;let o=So(t,r);return o?(e(t.update({selection:t.selection.addRange(h.range(o.from,o.to),!1),effects:p.scrollIntoView(o.to)})),!0):!1},J=ee.define({combine(t){return xe(t,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new wo(e),scrollToMatch:e=>p.scrollIntoView(e)})}});class Yt{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||lo(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(n,r)=>r=="n"?`
`:r=="r"?"\r":r=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new Mo(this):new Ao(this)}getCursor(e,n=0,r){let o=e.doc?e:z.create({doc:e});return r==null&&(r=o.doc.length),this.regexp?V(this,o,n,r):U(this,o,n,r)}}class Zt{constructor(e){this.spec=e}}function U(t,e,n,r){return new $(e.doc,t.unquoted,n,r,t.caseSensitive?void 0:o=>o.toLowerCase(),t.wholeWord?Co(e.doc,e.charCategorizer(e.selection.main.head)):void 0)}function Co(t,e){return(n,r,o,i)=>((i>n||i+o.length<r)&&(i=Math.max(0,n-2),o=t.sliceString(i,Math.min(t.length,r+2))),(e(me(o,n-i))!=v.Word||e(pe(o,n-i))!=v.Word)&&(e(pe(o,r-i))!=v.Word||e(me(o,r-i))!=v.Word))}class Ao extends Zt{constructor(e){super(e)}nextMatch(e,n,r){let o=U(this.spec,e,r,e.doc.length).nextOverlapping();return o.done&&(o=U(this.spec,e,0,n).nextOverlapping()),o.done?null:o.value}prevMatchInRange(e,n,r){for(let o=r;;){let i=Math.max(n,o-1e4-this.spec.unquoted.length),s=U(this.spec,e,i,o),l=null;for(;!s.nextOverlapping().done;)l=s.value;if(l)return l;if(i==n)return null;o-=1e4}}prevMatch(e,n,r){return this.prevMatchInRange(e,0,n)||this.prevMatchInRange(e,r,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,n){let r=U(this.spec,e,0,e.doc.length),o=[];for(;!r.next().done;){if(o.length>=n)return null;o.push(r.value)}return o}highlight(e,n,r,o){let i=U(this.spec,e,Math.max(0,n-this.spec.unquoted.length),Math.min(r+this.spec.unquoted.length,e.doc.length));for(;!i.next().done;)o(i.value.from,i.value.to)}}function V(t,e,n,r){return new _t(e.doc,t.search,{ignoreCase:!t.caseSensitive,test:t.wholeWord?vo(e.charCategorizer(e.selection.main.head)):void 0},n,r)}function me(t,e){return t.slice(W(t,e,!1),e)}function pe(t,e){return t.slice(e,W(t,e))}function vo(t){return(e,n,r)=>!r[0].length||(t(me(r.input,r.index))!=v.Word||t(pe(r.input,r.index))!=v.Word)&&(t(pe(r.input,r.index+r[0].length))!=v.Word||t(me(r.input,r.index+r[0].length))!=v.Word)}class Mo extends Zt{nextMatch(e,n,r){let o=V(this.spec,e,r,e.doc.length).next();return o.done&&(o=V(this.spec,e,0,n).next()),o.done?null:o.value}prevMatchInRange(e,n,r){for(let o=1;;o++){let i=Math.max(n,r-o*1e4),s=V(this.spec,e,i,r),l=null;for(;!s.next().done;)l=s.value;if(l&&(i==n||l.from>i+10))return l;if(i==n)return null}}prevMatch(e,n,r){return this.prevMatchInRange(e,0,n)||this.prevMatchInRange(e,r,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace).replace(/\$([$&\d+])/g,(n,r)=>r=="$"?"$":r=="&"?e.match[0]:r!="0"&&+r<e.match.length?e.match[r]:n)}matchAll(e,n){let r=V(this.spec,e,0,e.doc.length),o=[];for(;!r.next().done;){if(o.length>=n)return null;o.push(r.value)}return o}highlight(e,n,r,o){let i=V(this.spec,e,Math.max(0,n-250),Math.min(r+250,e.doc.length));for(;!i.next().done;)o(i.value.from,i.value.to)}}const Y=D.define(),$e=D.define(),w=ke.define({create(t){return new Be(Fe(t).create(),null)},update(t,e){for(let n of e.effects)n.is(Y)?t=new Be(n.value.create(),t.panel):n.is($e)&&(t=new Be(t.query,n.value?Ge:null));return t},provide:t=>Ve.from(t,e=>e.panel)});class Be{constructor(e,n){this.query=e,this.panel=n}}const Lo=g.mark({class:"cm-searchMatch"}),Do=g.mark({class:"cm-searchMatch cm-searchMatch-selected"}),Bo=dt.fromClass(class{constructor(t){this.view=t,this.decorations=this.highlight(t.state.field(w))}update(t){let e=t.state.field(w);(e!=t.startState.field(w)||t.docChanged||t.selectionSet||t.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:t,panel:e}){if(!e||!t.spec.valid)return g.none;let{view:n}=this,r=new xn;for(let o=0,i=n.visibleRanges,s=i.length;o<s;o++){let{from:l,to:c}=i[o];for(;o<s-1&&c>i[o+1].from-2*250;)c=i[++o].to;t.highlight(n.state,l,c,(a,u)=>{let f=n.state.selection.ranges.some(m=>m.from==a&&m.to==u);r.add(a,u,f?Do:Lo)})}return r.finish()}},{decorations:t=>t.decorations});function ne(t){return e=>{let n=e.state.field(w,!1);return n&&n.query.spec.valid?t(e,n):tn(e)}}const ge=ne((t,{query:e})=>{let{to:n}=t.state.selection.main,r=e.nextMatch(t.state,n,n);if(!r)return!1;let o=h.single(r.from,r.to),i=t.state.facet(J);return t.dispatch({selection:o,effects:[He(t,r),i.scrollToMatch(o.main,t)],userEvent:"select.search"}),en(t),!0}),ye=ne((t,{query:e})=>{let{state:n}=t,{from:r}=n.selection.main,o=e.prevMatch(n,r,r);if(!o)return!1;let i=h.single(o.from,o.to),s=t.state.facet(J);return t.dispatch({selection:i,effects:[He(t,o),s.scrollToMatch(i.main,t)],userEvent:"select.search"}),en(t),!0}),Oo=ne((t,{query:e})=>{let n=e.matchAll(t.state,1e3);return!n||!n.length?!1:(t.dispatch({selection:h.create(n.map(r=>h.range(r.from,r.to))),userEvent:"select.search.matches"}),!0)}),Ro=({state:t,dispatch:e})=>{let n=t.selection;if(n.ranges.length>1||n.main.empty)return!1;let{from:r,to:o}=n.main,i=[],s=0;for(let l=new $(t.doc,t.sliceDoc(r,o));!l.next().done;){if(i.length>1e3)return!1;l.value.from==r&&(s=i.length),i.push(h.range(l.value.from,l.value.to))}return e(t.update({selection:h.create(i,s),userEvent:"select.search.matches"})),!0},ot=ne((t,{query:e})=>{let{state:n}=t,{from:r,to:o}=n.selection.main;if(n.readOnly)return!1;let i=e.nextMatch(n,r,r);if(!i)return!1;let s=[],l,c,a=[];if(i.from==r&&i.to==o&&(c=n.toText(e.getReplacement(i)),s.push({from:i.from,to:i.to,insert:c}),i=e.nextMatch(n,i.from,i.to),a.push(p.announce.of(n.phrase("replaced match on line $",n.doc.lineAt(r).number)+"."))),i){let u=s.length==0||s[0].from>=i.to?0:i.to-i.from-c.length;l=h.single(i.from-u,i.to-u),a.push(He(t,i)),a.push(n.facet(J).scrollToMatch(l.main,t))}return t.dispatch({changes:s,selection:l,effects:a,userEvent:"input.replace"}),!0}),To=ne((t,{query:e})=>{if(t.state.readOnly)return!1;let n=e.matchAll(t.state,1e9).map(o=>{let{from:i,to:s}=o;return{from:i,to:s,insert:e.getReplacement(o)}});if(!n.length)return!1;let r=t.state.phrase("replaced $ matches",n.length)+".";return t.dispatch({changes:n,effects:p.announce.of(r),userEvent:"input.replace.all"}),!0});function Ge(t){return t.state.facet(J).createPanel(t)}function Fe(t,e){var n,r,o,i,s;let l=t.selection.main,c=l.empty||l.to>l.from+100?"":t.sliceDoc(l.from,l.to);if(e&&!c)return e;let a=t.facet(J);return new Yt({search:((n=e==null?void 0:e.literal)!==null&&n!==void 0?n:a.literal)?c:c.replace(/\n/g,"\\n"),caseSensitive:(r=e==null?void 0:e.caseSensitive)!==null&&r!==void 0?r:a.caseSensitive,literal:(o=e==null?void 0:e.literal)!==null&&o!==void 0?o:a.literal,regexp:(i=e==null?void 0:e.regexp)!==null&&i!==void 0?i:a.regexp,wholeWord:(s=e==null?void 0:e.wholeWord)!==null&&s!==void 0?s:a.wholeWord})}function Xt(t){let e=Q(t,Ge);return e&&e.dom.querySelector("[main-field]")}function en(t){let e=Xt(t);e&&e==t.root.activeElement&&e.select()}const tn=t=>{let e=t.state.field(w,!1);if(e&&e.panel){let n=Xt(t);if(n&&n!=t.root.activeElement){let r=Fe(t.state,e.query.spec);r.valid&&t.dispatch({effects:Y.of(r)}),n.focus(),n.select()}}else t.dispatch({effects:[$e.of(!0),e?Y.of(Fe(t.state,e.query.spec)):D.appendConfig.of(Io)]});return!0},nn=t=>{let e=t.state.field(w,!1);if(!e||!e.panel)return!1;let n=Q(t,Ge);return n&&n.dom.contains(t.root.activeElement)&&t.focus(),t.dispatch({effects:$e.of(!1)}),!0},Eo=[{key:"Mod-f",run:tn,scope:"editor search-panel"},{key:"F3",run:ge,shift:ye,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:ge,shift:ye,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:nn,scope:"editor search-panel"},{key:"Mod-Shift-l",run:Ro},{key:"Mod-Alt-g",run:co},{key:"Mod-d",run:bo,preventDefault:!0}];class wo{constructor(e){this.view=e;let n=this.query=e.state.field(w).query.spec;this.commit=this.commit.bind(this),this.searchField=d("input",{value:n.search,placeholder:C(e,"Find"),"aria-label":C(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=d("input",{value:n.replace,placeholder:C(e,"Replace"),"aria-label":C(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=d("input",{type:"checkbox",name:"case",form:"",checked:n.caseSensitive,onchange:this.commit}),this.reField=d("input",{type:"checkbox",name:"re",form:"",checked:n.regexp,onchange:this.commit}),this.wordField=d("input",{type:"checkbox",name:"word",form:"",checked:n.wholeWord,onchange:this.commit});function r(o,i,s){return d("button",{class:"cm-button",name:o,onclick:i,type:"button"},s)}this.dom=d("div",{onkeydown:o=>this.keydown(o),class:"cm-search"},[this.searchField,r("next",()=>ge(e),[C(e,"next")]),r("prev",()=>ye(e),[C(e,"previous")]),r("select",()=>Oo(e),[C(e,"all")]),d("label",null,[this.caseField,C(e,"match case")]),d("label",null,[this.reField,C(e,"regexp")]),d("label",null,[this.wordField,C(e,"by word")]),...e.state.readOnly?[]:[d("br"),this.replaceField,r("replace",()=>ot(e),[C(e,"replace")]),r("replaceAll",()=>To(e),[C(e,"replace all")])],d("button",{name:"close",onclick:()=>nn(e),"aria-label":C(e,"close"),type:"button"},["×"])])}commit(){let e=new Yt({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:Y.of(e)}))}keydown(e){kn(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?ye:ge)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),ot(this.view))}update(e){for(let n of e.transactions)for(let r of n.effects)r.is(Y)&&!r.value.eq(this.query)&&this.setQuery(r.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(J).top}}function C(t,e){return t.state.phrase(e)}const ie=30,se=/[\s\.,:;?!]/;function He(t,{from:e,to:n}){let r=t.state.doc.lineAt(e),o=t.state.doc.lineAt(n).to,i=Math.max(r.from,e-ie),s=Math.min(o,n+ie),l=t.state.sliceDoc(i,s);if(i!=r.from){for(let c=0;c<ie;c++)if(!se.test(l[c+1])&&se.test(l[c])){l=l.slice(c);break}}if(s!=o){for(let c=l.length-1;c>l.length-ie;c--)if(!se.test(l[c-1])&&se.test(l[c])){l=l.slice(0,c);break}}return p.announce.of(`${t.state.phrase("current match")}. ${l} ${t.state.phrase("on line")} ${r.number}.`)}const Po=p.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),Io=[w,gn.low(Bo),Po];class Fo{constructor(e,n,r){this.from=e,this.to=n,this.diagnostic=r}}class I{constructor(e,n,r){this.diagnostics=e,this.panel=n,this.selected=r}static init(e,n,r){let o=e,i=r.facet(Z).markerFilter;i&&(o=i(o,r));let s=g.set(o.map(l=>l.from==l.to||l.from==l.to-1&&r.doc.lineAt(l.from).to==l.from?g.widget({widget:new Go(l),diagnostic:l}).range(l.from):g.mark({attributes:{class:"cm-lintRange cm-lintRange-"+l.severity+(l.markClass?" "+l.markClass:"")},diagnostic:l}).range(l.from,l.to)),!0);return new I(s,n,G(s))}}function G(t,e=null,n=0){let r=null;return t.between(n,1e9,(o,i,{spec:s})=>{if(!(e&&s.diagnostic!=e))return r=new Fo(o,i,s.diagnostic),!1}),r}function Wo(t,e){let n=e.pos,r=e.end||n,o=t.state.facet(Z).hideOn(t,n,r);if(o!=null)return o;let i=t.startState.doc.lineAt(e.pos);return!!(t.effects.some(s=>s.is(rn))||t.changes.touchesRange(i.from,Math.max(i.to,r)))}function Uo(t,e){return t.field(A,!1)?e:e.concat(D.appendConfig.of(Ko))}const rn=D.define(),Je=D.define(),on=D.define(),A=ke.define({create(){return new I(g.none,null,null)},update(t,e){if(e.docChanged&&t.diagnostics.size){let n=t.diagnostics.map(e.changes),r=null,o=t.panel;if(t.selected){let i=e.changes.mapPos(t.selected.from,1);r=G(n,t.selected.diagnostic,i)||G(n,null,i)}!n.size&&o&&e.state.facet(Z).autoPanel&&(o=null),t=new I(n,o,r)}for(let n of e.effects)if(n.is(rn)){let r=e.state.facet(Z).autoPanel?n.value.length?X.open:null:t.panel;t=I.init(n.value,r,e.state)}else n.is(Je)?t=new I(t.diagnostics,n.value?X.open:null,t.selected):n.is(on)&&(t=new I(t.diagnostics,t.panel,n.value));return t},provide:t=>[Ve.from(t,e=>e.panel),p.decorations.from(t,e=>e.diagnostics)]}),Vo=g.mark({class:"cm-lintRange cm-lintRange-active"});function qo(t,e,n){let{diagnostics:r}=t.state.field(A),o=[],i=2e8,s=0;r.between(e-(n<0?1:0),e+(n>0?1:0),(c,a,{spec:u})=>{e>=c&&e<=a&&(c==a||(e>c||n>0)&&(e<a||n<0))&&(o.push(u.diagnostic),i=Math.min(c,i),s=Math.max(a,s))});let l=t.state.facet(Z).tooltipFilter;return l&&(o=l(o,t.state)),o.length?{pos:i,end:s,above:t.state.doc.lineAt(i).to<s,create(){return{dom:No(t,o)}}}:null}function No(t,e){return d("ul",{class:"cm-tooltip-lint"},e.map(n=>ln(t,n,!1)))}const zo=t=>{let e=t.state.field(A,!1);(!e||!e.panel)&&t.dispatch({effects:Uo(t.state,[Je.of(!0)])});let n=Q(t,X.open);return n&&n.dom.querySelector(".cm-panel-lint ul").focus(),!0},it=t=>{let e=t.state.field(A,!1);return!e||!e.panel?!1:(t.dispatch({effects:Je.of(!1)}),!0)},jo=t=>{let e=t.state.field(A,!1);if(!e)return!1;let n=t.state.selection.main,r=e.diagnostics.iter(n.to+1);return!r.value&&(r=e.diagnostics.iter(0),!r.value||r.from==n.from&&r.to==n.to)?!1:(t.dispatch({selection:{anchor:r.from,head:r.to},scrollIntoView:!0}),!0)},$o=[{key:"Mod-Shift-m",run:zo,preventDefault:!0},{key:"F8",run:jo}],Z=ee.define({combine(t){return Object.assign({sources:t.map(e=>e.source).filter(e=>e!=null)},xe(t.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{needsRefresh:(e,n)=>e?n?r=>e(r)||n(r):e:n}))}});function sn(t){let e=[];if(t)e:for(let{name:n}of t){for(let r=0;r<n.length;r++){let o=n[r];if(/[a-zA-Z]/.test(o)&&!e.some(i=>i.toLowerCase()==o.toLowerCase())){e.push(o);continue e}}e.push("")}return e}function ln(t,e,n){var r;let o=n?sn(e.actions):[];return d("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},d("span",{class:"cm-diagnosticText"},e.renderMessage?e.renderMessage(t):e.message),(r=e.actions)===null||r===void 0?void 0:r.map((i,s)=>{let l=!1,c=m=>{if(m.preventDefault(),l)return;l=!0;let y=G(t.state.field(A).diagnostics,e);y&&i.apply(t,y.from,y.to)},{name:a}=i,u=o[s]?a.indexOf(o[s]):-1,f=u<0?a:[a.slice(0,u),d("u",a.slice(u,u+1)),a.slice(u+1)];return d("button",{type:"button",class:"cm-diagnosticAction",onclick:c,onmousedown:c,"aria-label":` Action: ${a}${u<0?"":` (access key "${o[s]})"`}.`},f)}),e.source&&d("div",{class:"cm-diagnosticSource"},e.source))}class Go extends bn{constructor(e){super(),this.diagnostic=e}eq(e){return e.diagnostic==this.diagnostic}toDOM(){return d("span",{class:"cm-lintPoint cm-lintPoint-"+this.diagnostic.severity})}}class st{constructor(e,n){this.diagnostic=n,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=ln(e,n,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class X{constructor(e){this.view=e,this.items=[];let n=o=>{if(o.keyCode==27)it(this.view),this.view.focus();else if(o.keyCode==38||o.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(o.keyCode==40||o.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(o.keyCode==36)this.moveSelection(0);else if(o.keyCode==35)this.moveSelection(this.items.length-1);else if(o.keyCode==13)this.view.focus();else if(o.keyCode>=65&&o.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:i}=this.items[this.selectedIndex],s=sn(i.actions);for(let l=0;l<s.length;l++)if(s[l].toUpperCase().charCodeAt(0)==o.keyCode){let c=G(this.view.state.field(A).diagnostics,i);c&&i.actions[l].apply(e,c.from,c.to)}}else return;o.preventDefault()},r=o=>{for(let i=0;i<this.items.length;i++)this.items[i].dom.contains(o.target)&&this.moveSelection(i)};this.list=d("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:n,onclick:r}),this.dom=d("div",{class:"cm-panel-lint"},this.list,d("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>it(this.view)},"×")),this.update()}get selectedIndex(){let e=this.view.state.field(A).selected;if(!e)return-1;for(let n=0;n<this.items.length;n++)if(this.items[n].diagnostic==e.diagnostic)return n;return-1}update(){let{diagnostics:e,selected:n}=this.view.state.field(A),r=0,o=!1,i=null;for(e.between(0,this.view.state.doc.length,(s,l,{spec:c})=>{let a=-1,u;for(let f=r;f<this.items.length;f++)if(this.items[f].diagnostic==c.diagnostic){a=f;break}a<0?(u=new st(this.view,c.diagnostic),this.items.splice(r,0,u),o=!0):(u=this.items[a],a>r&&(this.items.splice(r,a-r),o=!0)),n&&u.diagnostic==n.diagnostic?u.dom.hasAttribute("aria-selected")||(u.dom.setAttribute("aria-selected","true"),i=u):u.dom.hasAttribute("aria-selected")&&u.dom.removeAttribute("aria-selected"),r++});r<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)o=!0,this.items.pop();this.items.length==0&&(this.items.push(new st(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),o=!0),i?(this.list.setAttribute("aria-activedescendant",i.id),this.view.requestMeasure({key:this,read:()=>({sel:i.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:s,panel:l})=>{let c=l.height/this.list.offsetHeight;s.top<l.top?this.list.scrollTop-=(l.top-s.top)/c:s.bottom>l.bottom&&(this.list.scrollTop+=(s.bottom-l.bottom)/c)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),o&&this.sync()}sync(){let e=this.list.firstChild;function n(){let r=e;e=r.nextSibling,r.remove()}for(let r of this.items)if(r.dom.parentNode==this.list){for(;e!=r.dom;)n();e=r.dom.nextSibling}else this.list.insertBefore(r.dom,e);for(;e;)n()}moveSelection(e){if(this.selectedIndex<0)return;let n=this.view.state.field(A),r=G(n.diagnostics,this.items[e].diagnostic);r&&this.view.dispatch({selection:{anchor:r.from,head:r.to},scrollIntoView:!0,effects:on.of(r)})}static open(e){return new X(e)}}function Ho(t,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(t)}</svg>')`}function le(t){return Ho(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${t}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const Jo=p.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:le("#d11")},".cm-lintRange-warning":{backgroundImage:le("orange")},".cm-lintRange-info":{backgroundImage:le("#999")},".cm-lintRange-hint":{backgroundImage:le("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}}),Ko=[A,p.decorations.compute([A],t=>{let{selected:e,panel:n}=t.field(A);return!e||!n||e.from==e.to?g.none:g.set([Vo.range(e.from,e.to)])}),Sn(qo,{hideOn:Wo}),Jo],_o=[Cn(),An(),vn(),or(),Mn(),Ln(),Dn(),z.allowMultipleSelections.of(!0),Bn(),On(Vn,{fallback:!0}),Rn(),Tn(),En(),wn(),Pn(),In(),ho(),mt.of([...Fn,...io,...Eo,...dr,...Wn,...Un,...$o])];/*!
* VueCodemirror v6.1.1
* Copyright (c) Surmon. All rights reserved.
* Released under the MIT License.
* Surmon
*/var Qo=Object.freeze({autofocus:!1,disabled:!1,indentWithTab:!0,tabSize:2,placeholder:"",autoDestroy:!0,extensions:[_o]}),cn=Symbol("vue-codemirror-global-config"),k,Yo=function(t){var e=t.onUpdate,n=t.onChange,r=t.onFocus,o=t.onBlur,i=function(s,l){var c={};for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&l.indexOf(a)<0&&(c[a]=s[a]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function"){var u=0;for(a=Object.getOwnPropertySymbols(s);u<a.length;u++)l.indexOf(a[u])<0&&Object.prototype.propertyIsEnumerable.call(s,a[u])&&(c[a[u]]=s[a[u]])}return c}(t,["onUpdate","onChange","onFocus","onBlur"]);return z.create({doc:i.doc,selection:i.selection,extensions:(Array.isArray(i.extensions)?i.extensions:[i.extensions]).concat([p.updateListener.of(function(s){e(s),s.docChanged&&n(s.state.doc.toString(),s),s.focusChanged&&(s.view.hasFocus?r(s):o(s))})])})},q=function(t){var e=new Nn;return{compartment:e,run:function(n){e.get(t.state)?t.dispatch({effects:e.reconfigure(n)}):t.dispatch({effects:D.appendConfig.of(e.of(n))})}}},lt=function(t,e){var n=q(t),r=n.compartment,o=n.run;return function(i){var s=r.get(t.state);o(i??s!==e?e:[])}},ce={type:Boolean,default:void 0},Zo={autofocus:ce,disabled:ce,indentWithTab:ce,tabSize:Number,placeholder:String,style:Object,autoDestroy:ce,phrases:Object,root:Object,extensions:Array,selection:Object},Xo={modelValue:{type:String,default:""}},ei=Object.assign(Object.assign({},Zo),Xo);(function(t){t.Change="change",t.Update="update",t.Focus="focus",t.Blur="blur",t.Ready="ready",t.ModelUpdate="update:modelValue"})(k||(k={}));var F={};F[k.Change]=function(t,e){return!0},F[k.Update]=function(t){return!0},F[k.Focus]=function(t){return!0},F[k.Blur]=function(t){return!0},F[k.Ready]=function(t){return!0};var an={};an[k.ModelUpdate]=F[k.Change];var ti=Object.assign(Object.assign({},F),an),ae=zn({name:"VueCodemirror",props:Object.assign({},ei),emits:Object.assign({},ti),setup:function(t,e){var n=Me(),r=Me(),o=Me(),i=Object.assign(Object.assign({},Qo),jn(cn,{})),s=$n(function(){var l={};return Object.keys(Kn(t)).forEach(function(c){var a;c!=="modelValue"&&(l[c]=(a=t[c])!==null&&a!==void 0?a:i[c])}),l});return Gn(function(){var l;r.value=Yo({doc:t.modelValue,selection:s.value.selection,extensions:(l=i.extensions)!==null&&l!==void 0?l:[],onFocus:function(a){return e.emit(k.Focus,a)},onBlur:function(a){return e.emit(k.Blur,a)},onUpdate:function(a){return e.emit(k.Update,a)},onChange:function(a,u){a!==t.modelValue&&(e.emit(k.Change,a,u),e.emit(k.ModelUpdate,a,u))}}),o.value=function(a){return new p(Object.assign({},a))}({state:r.value,parent:n.value,root:s.value.root});var c=function(a){var u=function(){return a.state.doc.toString()},f=q(a).run,m=lt(a,[p.editable.of(!1),z.readOnly.of(!0)]),y=lt(a,mt.of([so])),O=q(a).run,re=q(a).run,K=q(a).run,un=q(a).run;return{focus:function(){return a.focus()},getDoc:u,setDoc:function(b){b!==u()&&a.dispatch({changes:{from:0,to:a.state.doc.length,insert:b}})},reExtensions:f,toggleDisabled:m,toggleIndentWithTab:y,setTabSize:function(b){O([z.tabSize.of(b),ft.of(" ".repeat(b))])},setPhrases:function(b){re([z.phrases.of(b)])},setPlaceholder:function(b){K(qn(b))},setStyle:function(b){b===void 0&&(b={}),un(p.theme({"&":Object.assign({},b)}))}}}(o.value);E(function(){return t.modelValue},function(a){a!==c.getDoc()&&c.setDoc(a)}),E(function(){return t.extensions},function(a){return c.reExtensions(a||[])},{immediate:!0}),E(function(){return s.value.disabled},function(a){return c.toggleDisabled(a)},{immediate:!0}),E(function(){return s.value.indentWithTab},function(a){return c.toggleIndentWithTab(a)},{immediate:!0}),E(function(){return s.value.tabSize},function(a){return c.setTabSize(a)},{immediate:!0}),E(function(){return s.value.phrases},function(a){return c.setPhrases(a||{})},{immediate:!0}),E(function(){return s.value.placeholder},function(a){return c.setPlaceholder(a)},{immediate:!0}),E(function(){return s.value.style},function(a){return c.setStyle(a)},{immediate:!0}),s.value.autofocus&&c.focus(),e.emit(k.Ready,{state:r.value,view:o.value,container:n.value})}),Hn(function(){s.value.autoDestroy&&o.value&&function(l){l.destroy()}(o.value)}),function(){return Jn("div",{class:"v-codemirror",style:{display:"contents"},ref:n})}}}),ni=ae,ri=function(t,e){t.component(ae.name,ae),t.component("Codemirror",ae),function(n,r){n.provide(cn,r)}(t,e)},si={Codemirror:ni,install:ri};export{ni as Codemirror,Qo as DEFAULT_CONFIG,si as default,ri as install};
